<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="/articles/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/articles/favicon.ico" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/what-input@5.2.10/dist/what-input.min.js" integrity="sha256-ZLjSztVkz5q3lKFjN9AgL6qR7TGLE+qnTXnNNTWtMF4=" crossorigin="anonymous"></script>
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/foundation-sites@6.6.3/dist/css/foundation.min.css" integrity="sha256-ogmFxjqiTMnZhxCqVmcqTvjfe1Y/ec4WaRj/aQPvn+I=" crossorigin="anonymous"> -->
    <link rel="stylesheet" href="./foundation.min.css"> <!-- includes xlarge and xxlarge breakpoints -->
    <script src="https://cdn.jsdelivr.net/npm/foundation-sites@6.6.3/dist/js/foundation.min.js" integrity="sha256-pRF3zifJRA9jXGv++b06qwtSqX1byFQOLjqa2PTEb2o=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="./style.css">
    <title>Create Remote Development Server</title>
  </head>
  <body>

    <div class="grid-x grid-padding-x grid-padding-y">
      <div class="cell small-12 text-center">
        <h1>Create Remote Development Server</h1>
      </div>
      <div id="intro" class="cell small-12 text-center">
        <h2 class="h3">
          <a href="#intro" data-smooth-scroll>Introduction</a>
        </h2>
      </div>
      <div class="cell small-10 medium-8 large-7 xlarge-6 xxlarge-5">
        <p>
          There are circumstances when you local machine is not suitable for heavy processing or its operating system is incompatible with your target environment. In this case, your need to process your source code in an environment that is different than your local machine. This article examines the use of remote development server by means of DigitalOcean.
        </p>
        <p>
          There is nothing new in having data stored in one system and having it processed in another. While conceptually everything is very clear, the implementation details can greatly vary. This article focuses on so-called conventional server where there is no abstract layer between the OS itself and the tools used to process source code.
        </p>
        <p class="hide-for-large">
          <a href="./high-level-overview.png" target="_blank">Show high level overview</a>
        </p>
        <p class="show-for-large">
          <a data-toggle="diagram">
            Show high level overview
          </a>
          <div class="hide" id="diagram" data-toggler="hide">
            <div class="callout">
              <img src="./high-level-overview.png" alt="High level overview">
            </div>
          </div>
        </p>
        <p>
          The setup will consist of the following:
          <ul>
            <li>DigitalOcean</li>
            <li>Ubuntu 20.04 LTS (droplet image)</li>
            <li>OpenSSH (preinstalled on image)</li>
            <li>Node and nginx (development tooling)</li>
            <li>rsync and inotifywait</li>
          </ul>
        </p>
      </div>
      <div id="create-droplet" class="cell small-10 text-center">
        <h2 class="h3">
          <a href="#create-droplet" data-smooth-scroll>Create Droplet</a>
        </h2>
      </div>
      <div class="cell small-10 medium-8 large-7 xlarge-6 xxlarge-5">
        <p>
          Sign-up on DigitalOcean and create droplet. When choosing between a password-based authentication and SSH, choose password based as we will configure SSH keys later in this article. As mentioned in the beginning, choose Ubuntu distro version 20.04 LTS (why Docker was not chosen is explained below). Choose Droplet specs according to your workload needs. Other settings can be left with their default values. Choose data center close to your <em>physical</em> location otherwise you might <a href="https://serverfault.com/questions/35453/what-can-cause-slow-ssh-session">encounter poor SSH performance</a>.
        </p>
      </div>
      <div id="docker" class="cell small-10 text-center">
        <h2 class="h3">
          <a href="#docker" data-smooth-scroll>Docker</a>
        </h2>
      </div>
      <div class="cell small-10 medium-8 large-7 xlarge-6 xxlarge-5">
        <p>
          Initially I was planning on using Docker for this project. However, I ran into one specific technical detail: docker contains exit on non-zero error. In the scope of this project, this presented a difficulty in keeping docker containers running as, for example, a linter tool would exit with a non-zero exit code if there was an issue. While it is very possible to find a solution and keep docker containers running, I had no hard requirement to use docker.
        </p>
      </div>
      <div id="openssh" class="cell small-10 text-center">
        <h2 class="h3">
          <a href="#openssh" data-smooth-scroll>OpenSSH</a>
        </h2>
      </div>
      <div class="cell small-10 medium-8 large-7 xlarge-6 xxlarge-5">
        <p>
          Once your droplet is up and running, it is time to configure SSH keys to allow password-less authentication. My recommendation is to use keys with passphrase with key-agent running on your local machine. This allows to "cache" passphrase so you enter it only once when you start a new terminal session.
        </p>
        <ul>
          <li>Follow tutorial from <a href="https://www.digitalocean.com/docs/droplets/how-to/add-ssh-keys/">DigitalOcean</a></li>
          <li><a data-toggle="ssh-permissions">Make sure you set the correct permissions otherwise authentication will fail:</a></li>
          <div id="ssh-permissions" class="callout hide" data-toggler="hide">
            <ul>
              <li>The directory should be own by the user: <code>chown -R $USER:$USER</code></li>
              <li>The directory should have permissions 700 <code>chmod 700 ~/.ssh</code></li>
              <li>The file <code>authorized_keys</code> should have permissions 600: <code>chmod 600 ~/.ssh/authorized_keys</code> (applies to droplet)</li>
            </ul>
          </div>
          <li>Cache SSH passphrase by getting ssh-agent pid in your local machine: <code>eval "$(ssh-agent -s)"</code></li>
          <li>You can <a href="https://linuxize.com/post/using-the-ssh-config-file/">create SSH profile</a> in your home directory to create a "shortcut" to your SSH connection</li>
          <li>Try to connect to your droplet remotely via ssh: <code>ssh root@droplet_ip</code></li>
          <li>
            <a data-toggle="ssh-debugging">Try these debugging steps if something did not work as expected:</a>
          </li>
          <div id="ssh-debugging" class="callout hide" data-toggler="hide">
            <ul>
              <li><a href="https://linuxize.com/post/using-the-ssh-config-file/">Create SSH profile</a> in your droplet to enable log of connection: <code>LogLevel DEBUG</code></li>
              <li>Connect with verbose flag <code>-v</code> in your local machine: <code>ssh -v root@droplet_ip</code></li>
            </ul>
          </div>
          <li>Permit ssh connection through the firewall in your droplet: <code>ufw allow ssh</code></li>
          <li>If you are using non-standard ssh port see <a href="https://www.digitalocean.com/community/tutorials/ufw-essentials-common-firewall-rules-and-commands">this tutorial from DigitalOcean</a></li>
        </ul>
      </div>
      <div id="node" class="cell small-10 text-center">
        <h2 class="h3">
          <a href="#node" data-smooth-scroll>Node</a>
        </h2>
      </div>
      <div class="cell small-10 medium-8 large-7 xlarge-6 xxlarge-5">
        <p>…</p>
      </div>
      <div id="nginx" class="cell small-10 text-center">
        <h2 class="h3">
          <a href="#nginx" data-smooth-scroll>Nginx</a>
        </h2>
      </div>
      <div class="cell small-10 medium-8 large-7 xlarge-6 xxlarge-5">
        <p>…</p>
      </div>
      <div id="ufw" class="cell small-10 text-center">
        <h2 class="h3">
          <a href="#ufw" data-smooth-scroll>UFW</a>
        </h2>
      </div>
      <div class="cell small-10 medium-8 large-7 xlarge-6 xxlarge-5">
        <p>…</p>
      </div>
      <div id="non-root-user" class="cell small-10 text-center">
        <h2 class="h3">
          <a href="#non-root-user" data-smooth-scroll>Non-Root User</a>
        </h2>
      </div>
      <div class="cell small-10 medium-8 large-7 xlarge-6 xxlarge-5">
        <p>…</p>
      </div>
      <div id="rsync" class="cell small-10 text-center">
        <h2 class="h3">
          <a href="#rsync" data-smooth-scroll>Rsync</a>
        </h2>
      </div>
      <div class="cell small-10 medium-8 large-7 xlarge-6 xxlarge-5">
        <p>…</p>
      </div>
    </div>

    <script>
      $(document).ready(function(){
        const Foundation = $(document).foundation();
      });
    </script>

    </body>
</html>
